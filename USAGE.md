# 量化交易智能体 — 使用说明

> 访问地址：**https://dykvehicle.github.io/desktop-tutorial/**
>
> 纯前端应用，所有运算在浏览器端完成，手机/电脑/平板均可使用。

---

## 一、概述

这是一个**多策略协同的量化交易回测系统**，内置三种经典交易策略，通过信号融合、风险控制和回测验证帮你评估策略效果。

**核心能力：**
- 选择标的和时间范围，一键运行历史回测
- 查看权益曲线、绩效指标（夏普比率/最大回撤/胜率等）
- 分析单只标的的最新交易信号和技术指标图表
- 在线调整策略参数，对比不同参数下的回测表现

**当前数据：** 6只A股标的的合成模拟行情（2023-2025年），用于演示和学习。

---

## 二、页面导航

打开网站后，左侧是导航栏，共四个页面：

| 图标 | 页面 | 用途 |
|:---:|------|------|
| 🏠 | **仪表盘** | 查看系统概况：策略组合、风控规则、架构说明 |
| 🔬 | **回测引擎** | 核心功能，设置参数运行回测，查看结果 |
| 📡 | **信号分析** | 选择一只标的，查看技术指标和交易信号 |
| ⚙️ | **策略配置** | 用滑块调整三个策略的参数和权重 |

左下角实时显示**北京时间**和**市场状态**（交易中/午休/已收盘/休市）。

---

## 三、仪表盘（首页）

进入网站默认显示仪表盘，分为三个区域：

### 顶部 — 四张统计卡片
- **初始资金**：回测起始资金（默认 ¥1,000,000）
- **策略数量**：当前使用 3 个策略
- **信号阈值**：0.15，信号强度超过此值才触发交易
- **止损/止盈**：7% / 10%

### 中部左 — 策略组合
展示三个策略的名称、权重和简要说明：
- **MA 均线交叉（40%）**：短期均线上穿/下穿长期均线产生买卖信号，含60日趋势过滤
- **RSI 超买超卖（30%）**：RSI指标低于30为超卖（买入信号），高于70为超买（卖出信号）
- **MACD 交叉（30%）**：MACD柱状图由负转正为买入，由正转负为卖出

### 中部右 — 风控规则
列出所有风控约束，保护资金安全：
- **止损线 -7%**：亏损达7%自动平仓
- **止盈线 +10%**：盈利达10%自动止盈
- **移动止损**：盈利3%后激活，如果价格从最高点回撤5%则平仓锁定利润
- **信号共识**：至少2个策略同方向才确认买卖信号，避免假信号
- **交易冷却**：同一标的交易后等10个交易日才能再次交易

---

## 四、回测引擎（核心功能）

这是最重要的页面，用来验证策略在历史数据上的表现。

### 第一步：设置参数

左侧面板可以调整以下参数：

| 参数 | 默认值 | 说明 |
|------|--------|------|
| **标的选择** | 平安银行、贵州茅台 | 勾选想要回测的标的，最多可选6只 |
| **开始日期** | 2024-01-01 | 回测起始日期（数据范围2023-2025） |
| **结束日期** | 2025-06-30 | 回测结束日期 |
| **初始资金** | 1,000,000 | 起始资金金额 |
| **信号阈值** | 0.15 | 越高越保守（0.05=激进, 0.5=非常保守） |
| **止损比例** | 0.07 | 亏多少自动割肉（0.07=亏7%止损） |
| **止盈比例** | 0.10 | 赚多少自动锁利（0.10=赚10%止盈） |

### 第二步：运行回测

点击 **🚀 运行回测** 按钮，等待几秒钟（全部在浏览器端计算）。

### 第三步：看结果

右侧会展示完整的回测结果：

#### 绩效指标卡片（8个核心指标）

| 指标 | 含义 | 好/坏 |
|------|------|-------|
| **总收益率** | 整个回测期间赚了/亏了多少 | 绿色=赚, 红色=亏 |
| **最终权益** | 最后账户里有多少钱 | 越高越好 |
| **年化收益** | 换算成年化的收益率 | 跑赢大盘(~8%)算好 |
| **夏普比率** | 风险调整后的收益（越高越好） | >1=好, >2=优秀 |
| **最大回撤** | 从最高点到最低点的最大跌幅 | 越小越好, <10%理想 |
| **胜率** | 盈利交易占总卖出交易的比例 | >50%好 |
| **盈亏比** | 平均每笔盈利 / 平均每笔亏损 | >1=好, >1.5=优秀 |
| **交易笔数** | 总共发生了多少次交易 | 太少可能不够有意义 |

#### 权益曲线图
紫色折线图展示资金随时间的变化。鼠标悬停可查看具体日期和金额。
- 曲线上升 = 在赚钱
- 曲线下降 = 在亏钱
- 曲线越平稳越好（说明波动小）

#### 交易记录表格
每一笔交易的详细记录：

| 列 | 说明 |
|----|------|
| **日期** | 交易发生日期 |
| **标的** | 哪只股票 |
| **方向** | 绿色"买入"或红色"卖出" |
| **数量** | 买/卖了多少股 |
| **价格** | 成交价格（含滑点） |
| **手续费** | 本笔交易的手续费（0.1%） |
| **盈亏** | 卖出时的盈亏金额（绿色=赚, 红色=亏） |
| **原因** | 为什么交易：信号买入/信号卖出/止损/止盈/移动止损 |

### 玩法建议

1. **先用默认参数跑一遍**，了解系统是怎么运作的
2. **试试只选一只标的**，比如只勾"贵州茅台"，看单只标的的策略表现
3. **调整止损止盈**：把止损从0.07改成0.05（更紧），对比回撤是否变小
4. **调整信号阈值**：改成0.05（激进）会交易更频繁，改成0.5（保守）会交易更少
5. **换不同时间段**：比如只看2024年上半年 vs 下半年

---

## 五、信号分析

用来查看某只标的当前的交易信号和技术指标。

### 操作步骤

1. 从下拉菜单选择一只标的（如"600519.SH 贵州茅台"）
2. 设置分析的时间范围
3. 点击 **📡 分析信号**

### 结果解读

#### 信号摘要（三张卡片）
- **综合信号**：三个策略融合后的最终判断
  - 🟢 **买入** — 看多
  - 🔴 **卖出** — 看空
  - ⚪ **观望** — 信号不明确，不建议操作
- **最新价格**：标的最新收盘价
- **信号强度**：综合信号的强弱（绝对值越大信号越强）

#### 各策略信号明细
展示每个策略独立给出的信号：
- **MA交叉**：均线是金叉还是死叉
- **RSI**：当前是超买、超卖还是中性
- **MACD**：柱状图是在零轴上方还是下方

#### 价格走势图（上图）
- **白色线**：近60天收盘价走势
- **黄色虚线**：SMA10（10日均线）
- **紫色虚线**：SMA30（30日均线）
- 均线在价格上方 = 压力，下方 = 支撑
- 短期均线上穿长期均线 = 金叉（看多）

#### RSI 指标图（下图）
- **紫色线**：RSI 值（0-100）
- **红色区域（上方）**：超买区（RSI > 70），可能回调
- **绿色区域（下方）**：超卖区（RSI < 30），可能反弹
- RSI 在30-70之间 = 中性区域

---

## 六、策略配置

用滑块实时调整三个策略的参数。

### MA 均线交叉
| 参数 | 范围 | 默认 | 说明 |
|------|------|------|------|
| 短期均线 | 3-30 | 10 | 越小越灵敏（信号多但假信号也多） |
| 长期均线 | 15-120 | 30 | 越大越稳健（信号少但更可靠） |
| 策略权重 | 0-100% | 40% | 在融合信号中占多大比重 |

### RSI 策略
| 参数 | 范围 | 默认 | 说明 |
|------|------|------|------|
| RSI 周期 | 5-30 | 14 | 越小越灵敏 |
| 策略权重 | 0-100% | 30% | 在融合信号中占多大比重 |

### MACD 策略
| 参数 | 范围 | 默认 | 说明 |
|------|------|------|------|
| 快线周期 | 5-20 | 12 | MACD快线EMA周期 |
| 慢线周期 | 15-40 | 26 | MACD慢线EMA周期 |
| 策略权重 | 0-100% | 30% | 在融合信号中占多大比重 |

> **提示**：三个策略的权重建议加起来等于100%。调整后返回「回测引擎」页面运行回测，即可看到新参数下的策略表现。

---

## 七、实用技巧

### 新手推荐操作顺序
1. 先看 🏠 **仪表盘**，了解系统有哪些策略和风控规则
2. 到 🔬 **回测引擎**，用默认参数点击"运行回测"看结果
3. 到 📡 **信号分析**，选一只标的看技术指标图表
4. 到 ⚙️ **策略配置**，调整参数后回到回测引擎对比效果

### 参数调优思路
- **信号太少/不交易**：降低信号阈值（如 0.05）
- **交易太频繁/亏损多**：提高信号阈值（如 0.3）
- **止损太频繁**：放大止损比例（如 0.10）
- **利润总是回吐**：缩小止盈比例（如 0.05）或依赖移动止损
- **想更激进**：缩短MA均线周期（如5/15）
- **想更保守**：加长MA均线周期（如20/60）

### 对比实验
可以跑多次回测进行对比，比如：
- **实验1**：默认参数 → 记录收益率和夏普比率
- **实验2**：止损改5%、止盈改8% → 对比是否更好
- **实验3**：只用一只标的 → 看单标的策略效果
- **实验4**：只保留MA+MACD权重（MA 60%, MACD 40%, RSI 0%） → 看两策略组合效果

---

## 八、名词解释

| 术语 | 解释 |
|------|------|
| **SMA** | 简单移动平均线，过去N天收盘价的平均值 |
| **RSI** | 相对强弱指标，衡量涨跌力度的比值（0-100） |
| **MACD** | 指数平滑异同移动平均线，由快慢均线差值计算 |
| **金叉** | 短期均线从下方上穿长期均线，看涨信号 |
| **死叉** | 短期均线从上方下穿长期均线，看跌信号 |
| **夏普比率** | (收益率-无风险利率)/波动率，衡量风险调整收益 |
| **最大回撤** | 资金从最高点到最低点的最大跌幅 |
| **盈亏比** | 平均每笔盈利金额 / 平均每笔亏损金额 |
| **移动止损** | 价格上涨后自动上移止损线，锁定利润 |
| **信号共识** | 多个策略同时看涨/看跌才确认交易 |
| **合成数据** | 用数学模型随机生成的模拟行情，非真实市场数据 |

---

## 九、注意事项

1. **本系统使用合成模拟数据**，非真实市场行情，仅供策略研究和学习使用
2. 回测结果不代表未来表现，**历史收益不等于未来收益**
3. 所有计算在浏览器端完成，数据不会上传到任何服务器
4. 手机访问时，左侧导航会自动收缩为图标模式
5. 如果页面加载慢，可能是 Chart.js 从 CDN 加载需要时间，刷新即可
